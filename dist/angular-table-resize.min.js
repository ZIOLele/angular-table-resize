angular.module("ngTableResize",[]),angular.module("ngTableResize").directive("resizeable",["resizeStorage","$injector",function(t,e){function n(t,e,n){z=e,S=t,R=n,C=t.container?$(t.container):$(z).parent(),$(z).addClass("resize"),a(z,void 0,n,t),i(z,n,t),o(z,n,t)}function i(t,e,n){void 0!==n.bind&&(n.bind={update:function(){r(t),a(t,e,n)}})}function o(t,e,n){n.$watch(function(){return n.mode},function(i){i&&(r(t),a(t,y,e,n))})}function r(t){W=!0,u(t)}function s(t){$(t).outerWidth("100%"),$(t).find("th").width("auto")}function u(t){$(t).find("th").find(".handle").remove()}function l(t){y.push(t),r(z),a(z,y,R,S)}function a(e,n,i,o){y=n?n:$(e).find("th"),b=o.mode;var r=p(o,i);r&&(T=new r(e,y,C),D=t.loadTableSizes(e,o.mode),g=T.handles(y),w=T.ctrlColumns,T.setup(),c(D),g.each(function(t,n){d(e,n)}))}function c(t){return t?($(z).width("auto"),w.each(function(e,n){var i=$(n).attr("id"),o=t[i];$(n).css({width:o})}),void T.onTableReady()):void s(z)}function d(t,e){var n=$("<div>",{"class":"handle"});$(e).prepend(n);var i=T.handleMiddleware(n,e);h(t,n,i)}function h(t,e,n){$(e).mousedown(function(t){W&&(T.onFirstDrag(n,e),T.onTableReady(),W=!1);var i={};T.intervene&&(i=T.intervene.selector(n),i.column=i,i.orgWidth=$(i).width()),t.preventDefault(),$(e).addClass("active"),$("body").addClass("table-resize");var o=t.clientX,r=$(n).width();$(window).mousemove(f(n,o,r,i)),$(window).one("mouseup",m(e))})}function f(t,e,n,i){return function(o){var r=o.clientX,s=r-e,u=T.calculate(n,s);if(!T.restrict(u)){if(T.intervene){var l=T.intervene.calculator(i.orgWidth,s);if(T.intervene.restrict(l))return;$(i).width(l)}$(t).width(u)}}}function p(t,n){try{var i=n.mode?t.mode:"BasicResizer",o=e.get(i);return o}catch(r){return console.error("The resizer "+t.mode+" was not found"),null}}function m(t){return function(){$(t).removeClass("active"),$(window).unbind("mousemove"),$("body").removeClass("table-resize"),T.onEndDrag(),v()}}function v(){D||(D={}),$(y).each(function(t,e){var n=$(e).attr("id");n&&(D[n]=T.saveAttr(e))}),t.saveTableSizes(z,b,D)}var b,y=null,w=null,g=null,z=null,C=null,R=null,T=null,W=!0,S=null,D=null;return{restrict:"A",link:n,controller:function(){this.saveColumnSizes=v,this.unbindEvent=m,this.getResizer=p,this.calculateWidthEvent=f,this.bindEventToHandle=h,this.initHandle=d,this.setColumnSizes=c,this.initialiseAll=a,this.addColumn=l,this.deleteHandles=u,this.resetTable=s,this.cleanUpAll=r,this.watchModeChange=o,this.bindUtilityFunctions=i},scope:{mode:"=",bind:"=",container:"@"}}}]),angular.module("ngTableResize").directive("resizeableColumn",[function(){return{restrict:"A",link:function(t,e,n,i){i.resizeableController.addColumn(e[0])},require:{resizeableController:"^^resizeable"}}}]),angular.module("ngTableResize").service("resizeStorage",["$window",function(t){function e(t,e){var i=t.attr("id");return i?n+"."+t.attr("id")+"."+e:void console.error("Table has no id",t)}var n="ngColumnResize";this.loadTableSizes=function(n,i){var o=e(n,i),r=t.localStorage.getItem(o);return JSON.parse(r)},this.saveTableSizes=function(n,i,o){var r=e(n,i);if(r){var s=JSON.stringify(o);t.localStorage.setItem(r,s)}}}]),angular.module("ngTableResize").factory("ResizerModel",[function(){function t(t,e,n){this.minWidth=25,this.table=t,this.columns=e,this.container=n,this.handleColumns=this.handles(),this.ctrlColumns=this.ctrlColumns()}return t.prototype.setup=function(){$(this.container).css({overflowX:"hidden"})},t.prototype.onTableReady=function(){$(this.table).outerWidth("100%")},t.prototype.handles=function(){return this.columns},t.prototype.ctrlColumns=function(){return this.handleColumns},t.prototype.onFirstDrag=function(){$(this.ctrlColumns).each(function(t,e){$(e).width($(e).width())})},t.prototype.handleMiddleware=function(t,e){return e},t.prototype.restrict=function(t){return t<this.minWidth},t.prototype.calculate=function(t,e){return t+e},t.prototype.onEndDrag=function(){},t.prototype.saveAttr=function(t){return $(t).outerWidth()},t}]),angular.module("ngTableResize").factory("BasicResizer",["ResizerModel",function(t){function e(e,r,s){t.call(this,e,r,s),this.ctrlColumns=this.columns,this.intervene={selector:n,calculator:i,restrict:o}}function n(t){return $(t).next()}function i(t,e){return t-e}function o(t){return t<25}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflowX:"hidden"}),$(this.columns).first().css({width:"auto"})},e.prototype.handles=function(){return $(this.columns).not(":last")},e.prototype.onFirstDrag=function(){$(this.columns).each(function(t,e){$(e).width($(e).width())})},e.prototype.onEndDrag=function(){var t=$(this.table).outerWidth(),e=0;$(this.columns).each(function(n,i){var o=$(i).outerWidth(),r=o/t*100+"%";e+=o/t*100,$(i).css({width:r})})},e.prototype.saveAttr=function(t){return $(t)[0].style.width},e}]),angular.module("ngTableResize").factory("FixedResizer",["ResizerModel",function(t){function e(e,n,i){t.call(this,e,n,i),this.fixedColumn=$(e).find("th").first(),this.bound=!1}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflowX:"hidden"}),$(this.columns).first().css({width:"auto"})},e.prototype.handles=function(){return $(this.columns).not(":last")},e.prototype.ctrlColumns=function(){return $(this.columns).not(":first")},e.prototype.onFirstDrag=function(){$(this.ctrlColumns).each(function(t,e){$(e).width($(e).width())})},e.prototype.handleMiddleware=function(t,e){return $(e).next()},e.prototype.restrict=function(t){return this.bound?!(t<this.bound)||($(this.fixedColumn).width("auto"),this.bound=!1,!1):t<this.minWidth||($(this.fixedColumn).width()<=this.minWidth?(this.bound=t,$(this.fixedColumn).width(this.minWidth),!0):void 0)},e.prototype.calculate=function(t,e){return t-e},e}]),angular.module("ngTableResize").factory("OverflowResizer",["ResizerModel",function(t){function e(e,n,i){t.call(this,e,n,i)}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflow:"auto"})},e.prototype.onTableReady=function(){$(this.table).width(1)},e}]);